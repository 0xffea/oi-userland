Fix for CVE-2004-1377. This is not taken from a2ps-1.14 but rather created
based on the CVE description. pdiff.in and pdiff.m4 has the same tmpdir, but it
does not seem to be used, or the dir created anywhere. So I skipped pdiff.

diff -urN a2ps-4.13/contrib/fixps.in a2ps-4.13-fix/contrib/fixps.in
--- a2ps-4.13/contrib/fixps.in	2000-02-21 00:16:15.000000000 -0800
+++ a2ps-4.13-fix/contrib/fixps.in	2011-08-18 07:19:10.207791746 -0700
@@ -38,7 +38,6 @@
 run_gs=0
 # What action to perform: fixps, cat, check, and gs
 task=fixps
-tmpdir=/tmp/$program.$$
 verbose=echo
 
 # The version/usage strings
@@ -183,6 +182,11 @@
       exit 1;;
 esac
 
+tmpdir=$( mktemp -d -t fixps.XXXXXX )
+if [ -z "$tmpdir" ]; then
+  echo "Can't create temporary directory - quitting"
+  exit 1
+fi
 if test -n "$debug"; then
   # Set -x now if debugging
   set -x
@@ -191,7 +195,6 @@
   trap "/bin/rm -rf $tmpdir" 0 1 2 3 13 15
 fi
 
-mkdir $tmpdir
 fixps_sed=$tmpdir/fixps.sed
 
 # If printing from stdin, save into a tmp file
diff -urN a2ps-4.13/contrib/fixps.m4 a2ps-4.13-fix/contrib/fixps.m4
--- a2ps-4.13/contrib/fixps.m4	2000-02-21 00:16:02.000000000 -0800
+++ a2ps-4.13-fix/contrib/fixps.m4	2011-08-18 07:19:19.602142022 -0700
@@ -24,7 +24,6 @@
 run_gs=0
 # What action to perform: fixps, cat, check, and gs
 task=fixps
-tmpdir=/tmp/$program.$$
 verbose=echo
 
 # The version/usage strings
@@ -101,6 +100,11 @@
       exit 1;;
 esac
 
+tmpdir=$( mktemp -d -t fixps.XXXXXX )
+if [ -z "$tmpdir" ]; then
+  echo "Can't create temporary directory - quitting"
+  exit 1
+fi
 if test -n "$debug"; then
   # Set -x now if debugging
   set -x
@@ -109,7 +113,6 @@
   trap "/bin/rm -rf $tmpdir" 0 1 2 3 13 15
 fi
 
-mkdir $tmpdir
 fixps_sed=$tmpdir/fixps.sed
 
 # If printing from stdin, save into a tmp file
diff -urN a2ps-4.13/contrib/psmandup.in a2ps-4.13-fix/contrib/psmandup.in
--- a2ps-4.13/contrib/psmandup.in	1999-10-24 06:06:42.000000000 -0700
+++ a2ps-4.13-fix/contrib/psmandup.in	2011-08-18 07:19:28.387779180 -0700
@@ -36,7 +36,6 @@
 message=
 psselect=${PSSELECT:-psselect}
 psset=${PSSET:-psset}
-tmpdir=/tmp/$program.$$
 
 # These two must be kept in synch.  They are opposed.
 verbose=echo
@@ -177,6 +176,11 @@
       exit 1;;
 esac
 
+tmpdir=$( mktemp -d -t psmandup.XXXXXX )
+if [ -z "$tmpdir" ]; then
+  echo "Can't create temporary directory - quitting"
+  exit 1
+fi
 if test -n "$debug"; then
   # Set -x now if debugging
   set -x
@@ -185,8 +189,6 @@
   trap "/bin/rm -rf $tmpdir" 0 1 2 3 13 15
 fi
 
-mkdir $tmpdir
-
 # If printing from stdin, save into a tmp file
 if test $file = '-'; then
   file=$tmpdir/stdin.ps
diff -urN a2ps-4.13/contrib/psmandup.m4 a2ps-4.13-fix/contrib/psmandup.m4
--- a2ps-4.13/contrib/psmandup.m4	1999-10-24 05:46:52.000000000 -0700
+++ a2ps-4.13-fix/contrib/psmandup.m4	2011-08-18 07:20:00.973705908 -0700
@@ -22,7 +22,6 @@
 message=
 psselect=${PSSELECT:-psselect}
 psset=${PSSET:-psset}
-tmpdir=/tmp/$program.$$
 
 # These two must be kept in synch.  They are opposed.
 verbose=echo
@@ -95,6 +94,11 @@
       exit 1;;
 esac
 
+tmpdir=$( mktemp -d -t psmandup.XXXXXX )
+if [ -z "$tmpdir" ]; then
+  echo "Can't create temporary directory - quitting"
+  exit 1
+fi
 if test -n "$debug"; then
   # Set -x now if debugging
   set -x
@@ -103,8 +107,6 @@
   trap "/bin/rm -rf $tmpdir" 0 1 2 3 13 15
 fi
 
-mkdir $tmpdir
-
 # If printing from stdin, save into a tmp file
 if test $file = '-'; then
   file=$tmpdir/stdin.ps
